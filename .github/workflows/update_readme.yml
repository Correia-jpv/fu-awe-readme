name: fetch-repos
on:
  schedule:
    - cron:  '30 5 * * *'

  workflow_dispatch:

jobs:
  check:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        REPOS: [
          {
            owner: 'sindresorhus',
            repo: 'awesome',
          },
          {
          owner: 'sindresorhus',
          repo: 'awesome-nodejs',
          },
          {
          owner: 'JStumpp',
          repo: 'awesome-android',
          },
          {
          owner: 'sindresorhus',
          repo: 'awesome-electron',
          },
          {
          owner: 'vsouza',
          repo: 'awesome-ios',
          },
          {
          owner: 'jondot',
          repo: 'awesome-react-native',
          },
          {
          owner: 'dypsilon',
          repo: 'frontend-dev-bookmarks',
          },
          {
          owner: 'jaywcjlove',
          repo: 'awesome-mac',
          },
          {
          owner: 'serhii-londar',
          repo: 'open-source-mac-os-apps',
          },
          {
          owner: 'donnemartin',
          repo: 'awesome-aws',
          },
          {
          owner: 'quozd',
          repo: 'awesome-dotnet',
          },
          {
          owner: 'thibmaek',
          repo: 'awesome-raspberry-pi',
          },
          {
          owner: 'Solido',
          repo: 'awesome-flutter',
          },
          ]
    steps:
      - uses: actions/checkout@v2
      - name: Checkout origin repo
        uses: Correia-jpv/action-sync-repo@main
        env:
          SECRET_TOKEN: ${{ secrets.PAT }}
        with:
          src_repo: ${{ matrix.REPOS.owner }}/${{ matrix.REPOS.repo }}
          src_branch: 'HEAD'
          dest_repo: correia-jpv/fucking-${{ matrix.REPOS.repo }}
          dest_branch: 'main'


      - name: Setup python
        uses: actions/setup-python@v2
        with:
          python-version: 3.10.2


      - name: Update README
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
          python fucking-awesome.py
        env:
          PAT: ${{ secrets.pat }}
          ORIGIN_REPO: https://raw.githubusercontent.com/correia-jpv/fucking-${{ matrix.REPOS.repo }}/main/readme.md


      - name: Pushes README
        uses: dmnemec/copy_file_to_another_repo_action@main
        env:
          API_TOKEN_GITHUB: ${{ secrets.PAT }}
        with:
          source_file: 'results/readme.md'
          destination_repo: correia-jpv/fucking-${{ matrix.REPOS.repo }}
          rename: 'README.md'
          user_email: 'correia-jpv@users.noreply.github.com'
          user_name: 'correia-jpv'
          commit_message: 'âš¡ Update README'
        
        